(function(){var e={17:function(e){e.exports={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{coordinates:[113.19845060928338,23.202532692154747],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.2296811128399,23.202762328082542],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.18570856383155,23.181174826860683],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.19220450857188,23.153381532738535],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.1729665183812,23.12512293494406],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.22218579198648,23.184160539970662],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.21893781961705,23.138219123214654],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.22818204866945,23.09662856642943],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.18146121534892,23.086516208190133],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.27215459767768,23.17497351752452],type:"Point"}}]}},368:function(e,t,r){"use strict";var o=r(6848),n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("MapPage")],1)},i=[],a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"full-screen"},[t("div",{staticClass:"map-container",attrs:{id:"map"}}),t("div",{staticClass:"control-panel"},[t("div",{staticClass:"panel-section"},[t("div",{staticClass:"section-title"},[e._v("图层")]),e._l(e.layerList,(function(r,o){return t("div",{key:o,staticClass:"layer-item"},[t("input",{attrs:{type:"checkbox",id:`layer${o}`},domProps:{checked:r.checked},on:{click:function(t){return e.handleLayerClick(r,o)}}}),t("label",{attrs:{for:`layer${o}`}},[e._v(e._s(r.name))])])}))],2),t("div",{staticClass:"panel-section"},[t("div",{staticClass:"section-title"},[e._v("分析")]),t("div",{staticClass:"analysis-item"},[t("div",{staticClass:"analysis-label"},[e._v("分析范围")]),t("div",{staticClass:"analysis-input"},[t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.bufferDistance,expression:"bufferDistance",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:e.bufferDistance},on:{input:[function(t){t.target.composing||(e.bufferDistance=e._n(t.target.value))},e.validateBufferDistance],blur:function(t){return e.$forceUpdate()}}}),t("span",{staticClass:"unit"},[e._v("km")])])]),t("div",{staticClass:"analysis-item button-group"},[t("button",{staticClass:"upload-btn",on:{click:e.drawPolygon}},[e._v("绘制")]),t("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"fileInput",accept:".geojson"},on:{change:e.handleFileUpload}}),t("button",{staticClass:"upload-btn",on:{click:e.triggerFileInput}},[e._v("上传文件")])]),t("div",{staticClass:"analysis-item"},[t("button",{staticClass:"analysis-btn",on:{click:e.analysisEvaluate}},[e._v(" 分析评估 ")])]),t("div",[t("button",{staticClass:"clear-btn",on:{click:e.clear}},[e._v("清除")])])])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isAnalysis,expression:"isAnalysis"}],staticClass:"left-bottom-panel"},[t("div",{staticClass:"panel-section"},[t("div",{staticClass:"section-title"},[e._v("输出结果")]),t("div",{staticClass:"result-item"},[e.analysisResult.length>0?[e._v(" 存在交集：选址与"+e._s(e.analysisResult.join("/"))+"存在交集，请注意复核是否存在冲突 ")]:[e._v(" 不存在交集 ")]],2)])])])},s=[],p=(r(4114),r(8111),r(2489),r(116),r(7588),r(1701),r(7642),r(8004),r(3853),r(5876),r(2475),r(5024),r(1698),r(2488),r(8868)),y=r(8699),c=r(8047),l=r(9298),u=r(4190),d=r(9449),f=r(4453),g=r(995),m=r(6505),h=r(8343),w=r(5782),P=r(2123),F=r(5274);class v{constructor(e){if(!(e instanceof p.A))throw new Error("Invalid map object");this.map=e,this.updateZIndex()}addLayer(e){this.map.addLayer(e),this.updateZIndex()}removeLayer(e){this.map.removeLayer(e),this.updateZIndex()}getLayers(){return this.map.getLayers().getArray()}moveLayerUp(e){const t=this.getLayers(),r=t.indexOf(e);r>0&&(t.splice(r,1),t.splice(r-1,0,e),this.updateZIndex())}moveLayerDown(e){const t=this.getLayers(),r=t.indexOf(e);r<t.length-1&&(t.splice(r,1),t.splice(r+1,0,e),this.updateZIndex())}swapLayers(e,t){const r=this.getLayers(),o=r.indexOf(e),n=r.indexOf(t);-1!==o&&-1!==n&&(r[o]=t,r[n]=e,this.updateZIndex())}updateZIndex(){const e=this.getLayers();e.forEach(((e,t)=>{e.setZIndex(t)}))}}var A=v,b=r(8763);class L{constructor(e,t){this.map=e,this.layer=t,this.draw=null}addInteraction(e,t,r){this.draw&&this.map.removeInteraction(this.draw),this.draw=new b.Ay({source:this.layer.getSource(),type:e,style:r||new m.Ay({fill:new h.A({color:"rgba(255, 255, 255, 0.5)"}),stroke:new w.A({color:"#ffcc33",width:2}),image:new F.A({radius:7,fill:new h.A({color:"#ffcc33"})})})}),this.map.addInteraction(this.draw),this.draw.on("drawend",(e=>{this.map.removeInteraction(this.draw),t&&t(e.feature)}))}drawPoint(e,t){this.addInteraction("Point",e,t)}drawLine(e,t){this.addInteraction("LineString",e,t)}drawPolygon(e,t){this.addInteraction("Polygon",e,t)}}var C=L,S=r(3277),k=r(3754),j=r(3496),x=r(856),G=r(5897),I=r(1423),E=r(7867),_=r(3369),O=r(383),D=r(2674);class Z{static calculateArea(e){let t=e.getGeometry();if(!(t instanceof k.Ay))throw new Error("Invalid polygon object");const r=(0,S.UG)(t),o=(0,S.UG)(t,window.map.getView().getProjection()),n=(new P.A).writeFeatureObject(e,{featureProjection:"EPSG:3857"}),i=G.W(n),a=t.getArea();return console.log("area",r),console.log("area2",a),console.log("area3",i),console.log("area4",o),r}static calculateLength(e){let t=e.getGeometry();if(!(t instanceof j.A))throw new Error("Invalid line object");return(0,S.R3)(t)}intersection(e,t){let r=I.n1(e.getGeometry().getCoordinates()),o=I.n1(t.getGeometry().getCoordinates());const n=E.y(I.Lr([r,o]));if(n){let e=new x.A({geometry:new k.Ay(n.geometry.coordinates)});return e.setStyle(new m.Ay({fill:new h.A({color:"#ffff00"}),stroke:new w.A({color:"#0000ff",width:1})})),e}return console.log("No intersection found."),null}union(e,t){let r=I.n1(e.getGeometry().getCoordinates()),o=I.n1(t.getGeometry().getCoordinates());const n=_.K(I.Lr([r,o]));if(n){let e=new x.A({geometry:new k.Ay(n.geometry.coordinates)});return e.setStyle(new m.Ay({fill:new h.A({color:"#ffffff"}),stroke:new w.A({color:"#ffffff",width:1})})),e}return console.log("No union found."),null}difference(e,t){let r=I.n1(e.getGeometry().getCoordinates()),o=I.n1(t.getGeometry().getCoordinates());const n=O.i(I.Lr([r,o]));if(n){let e=new x.A({geometry:new k.Ay(n.geometry.coordinates)});return e.setStyle(new m.Ay({fill:new h.A({color:"#ffffff"}),stroke:new w.A({color:"#ff0000",width:1})})),e}return console.log("No difference found."),null}lineBuffer(e,t){const r=(new P.A).writeFeaturesObject(e,{featureProjection:"EPSG:3857"});let o=D.r(r,t,{units:"meters"});return(new P.A).readFeatures(o,{featureProjection:"EPSG:3857"})}polygonBuffer(e,t){const r=(new P.A).writeFeaturesObject(e,{featureProjection:"EPSG:3857"});let o=D.r(r,t,{units:"meters"});return(new P.A).readFeatures(o,{featureProjection:"EPSG:3857"})}}var R=Z,H=r(1861),N=r.n(H),B=r(2452),U=r.n(B),M=r(17),z=r.n(M),T=r(1458),$=r.n(T);let W=null,J=new m.Ay({image:new F.A({radius:5,fill:new h.A({color:"rgba(0,255,0,1)"})})}),K=new m.Ay({image:new F.A({radius:5,fill:new h.A({color:"rgba(255,0,0,1)"})})}),V=new m.Ay({image:new F.A({radius:5,fill:new h.A({color:"rgba(0,0,255,0.5)"})})});var q={name:"MapPage",data(){return{layerList:[{name:"重点建设项目",url:$(),checked:!1},{name:"重点项目选址",url:N(),checked:!1},{name:"重点功能片区",url:U(),checked:!1},{name:"重大项目安全控制区",url:z(),checked:!1}],mapCenter:[113.33779344641266,23.160504749489746],mapZoom:13,layerStatus:[],bufferDistance:1,analysisResult:new Set,isAnalysis:!1,bufferArray:[]}},mounted(){W=new p.A({target:"map",layers:[new c.A({zIndex:1,source:new l.A({url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"})})],view:new y.Ay({projection:"EPSG:3857",center:(0,d.Rb)(this.mapCenter),zoom:this.mapZoom}),interactions:(0,u.N)({doubleClickZoom:!1})}),this.layerHelper=new A(W),this.drawLayer=new f.A({style:new m.Ay({fill:new h.A({color:"rgba(143,195,179,0.7)"}),stroke:new w.A({color:"rgba( 79,253,253,1)"})}),source:new g.A({projection:"EPSG:3857"})}),this.layerHelper.addLayer(this.drawLayer),this.bufferLayer=new f.A({source:new g.A({projection:"EPSG:3857"}),style:new m.Ay({fill:new h.A({color:"rgba(143,195,179,0.7)"}),stroke:new w.A({color:"rgba( 79,253,253,1)"})})}),this.layerHelper.addLayer(this.bufferLayer),this.drawHelper=new C(W,this.drawLayer),this.computeHelper=new R,window.map=W},methods:{handleLayerClick(e){e.checked=!e.checked,e.checked?this.layerHelper.addLayer(this.loadGeojson(e.url,e.name)):this.layerHelper.removeLayer(this.loadGeojson(e.url,e.name))},loadGeojson(e,t){const r=this.layerStatus.find((e=>e.name===t));if(r)return r.layer;const o=new f.A({zIndex:3,source:new g.A({features:(new P.A).readFeatures(e,{featureProjection:"EPSG:3857"})}),style:J});return this.layerStatus.push({name:t,layer:o}),o},removeGeojsonLayer(e){const t=[];W.getLayers().forEach((r=>{r.getSource()instanceof g.A&&r.getSource().getUrl()===e&&t.push(r)})),t.forEach((e=>W.removeLayer(e)))},setFeatureStyle(e){e.setStyle(new m.Ay({fill:new h.A({color:"rgba(255,255,0,1)"})}))},analysisEvaluate(){this.bufferLayer.getSource().clear(),this.isAnalysis=!0,this.bufferArray=[];const e=this.drawLayer.getSource().getFeatures();e.forEach((e=>{let t=this.computeHelper.polygonBuffer([e],1e3*this.bufferDistance);t.length>0&&(this.bufferLayer.getSource().addFeatures(t),this.bufferArray.push(t[0]))})),this.isPointInBuffer(this.bufferArray)},drawPolygon(){this.drawHelper.drawPolygon((()=>{}))},isPointInBuffer(e){this.analysisResult=[];const t=[],r=[],o=this.layerList.filter((e=>e.checked));e.forEach((e=>{const n=e.getGeometry();o.forEach((e=>{const o=this.layerStatus.find((t=>t.name===e.name));if(!o)return;const i=o.layer.getSource().getFeatures();let a=!1;i.forEach((e=>{const o=e.getGeometry().getLastCoordinate();r.push(e),n.intersectsCoordinate(o)&&(t.push(e),a=!0)})),a&&!this.analysisResult.includes(e.name)&&this.analysisResult.push(e.name)}))})),r.forEach((e=>{const r=t.includes(e)?K:V;e.setStyle(r)}))},triggerFileInput(){document.getElementById("fileInput").click()},handleFileUpload(e){const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{const t=JSON.parse(e.target.result);this.loadGeojsonData(t)},e.readAsText(t)}e.target.value=""},loadGeojsonData(e){let t=(new P.A).readFeatures(e,{featureProjection:"EPSG:3857"});this.drawLayer.getSource().addFeatures(t)},clear(){this.analysisResult=new Set,this.isAnalysis=!1,this.drawLayer.getSource().clear(),this.bufferLayer.getSource().clear(),this.layerStatus.forEach((e=>{e.layer.getSource().forEachFeature((e=>{e.setStyle(J)}))}))},validateBufferDistance(){isNaN(this.bufferDistance)&&(this.bufferDistance=1)}}},Q=q,X=r(1656),Y=(0,X.A)(Q,a,s,!1,null,"3de6cea6",null),ee=Y.exports,te={name:"App",components:{MapPage:ee}},re=te,oe=(0,X.A)(re,n,i,!1,null,null,null),ne=oe.exports;o.Ay.config.productionTip=!1,new o.Ay({render:e=>e(ne)}).$mount("#app")},1458:function(e){e.exports={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{coordinates:[113.33779344641266,23.160504749489746],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.32539901556834,23.17170500826836],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.35421341889821,23.179495939998944],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.37423519180123,23.16381622789062],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.35972205483046,23.175600530823402],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.3595101842165,23.160504749489746],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.35887457237897,23.137906594253394],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.33228481048042,23.144238358201022],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.31205116696555,23.15378414459026],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.31342832594964,23.168296333035926],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.30474163082772,23.12923646323233],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.39425696470437,23.129528723967525],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.40029527716712,23.147355424438416],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.3988121828782,23.175210983669444],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.39891811818308,23.16703023156043],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.36046699222487,23.112014240929042],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.33864911690983,23.126260881118384],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.2670864858793,23.142913486252112],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.26599559211394,23.12786604153696],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.28061356857404,23.16096819045285],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.35741248968117,23.18824623702892],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.32206753167134,23.193460524562255],type:"Point"}}]}},1861:function(e){e.exports={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{coordinates:[113.367652912484,23.189902108455982],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.34141928949725,23.158205575802697],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.39613513172827,23.190591080136727],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.42886469945648,23.176121929614],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.38439246239096,23.163488852435606],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.41662233410551,23.153611252971757],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.43105539977518,23.132015825014832],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.3945781716215,23.143962661959193],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.37384111725925,23.14258423510141],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.38308534631159,23.114093574234957],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.40831959318643,23.1159318639654],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.44154884897068,23.112255259329913],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.44804479371078,23.14878704432654],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.35885047555246,23.114553149028026],type:"Point"}}]}},2452:function(e){e.exports={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{coordinates:[113.33494007810737,23.17681420308358],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.38773933636872,23.158561037130283],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.42199340061114,23.190853406207594],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.39515741397605,23.198474070842096],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.4499202810137,23.181226682810887],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.44599306345901,23.161770565279326],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.4270115119333,23.179622161562648],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.36897596359745,23.195465965633105],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.39777555901321,23.18604013110658],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.44752031473087,23.134286491135327],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.43922952211057,23.164378250268],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.41697528928887,23.17480848238374],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.42221157936547,23.137095341185386],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.41479350175825,23.15535143207626],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.41522985926485,23.11963939139531],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.38708480010791,23.13950288011125],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.35784884718777,23.159965215158778],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.31704942034912,23.14572215556612],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.31355856029876,23.157156844381703],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.28628621615496,23.138900999433105],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.30177690763026,23.123251153569484],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.31355856029876,23.12967182405012],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.35064894833272,23.147126468152763],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.38163033128126,23.12927054114877],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.36308513726209,23.12766539753585],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.3373400443923,23.1330826802469],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.37486678993281,23.178017621074744],type:"Point"}},{type:"Feature",properties:{},geometry:{coordinates:[113.38184851003348,23.114622893782723],type:"Point"}}]}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,r),i.exports}r.m=e,function(){var e=[];r.O=function(t,o,n,i){if(!o){var a=1/0;for(c=0;c<e.length;c++){o=e[c][0],n=e[c][1],i=e[c][2];for(var s=!0,p=0;p<o.length;p++)(!1&i||a>=i)&&Object.keys(r.O).every((function(e){return r.O[e](o[p])}))?o.splice(p--,1):(s=!1,i<a&&(a=i));if(s){e.splice(c--,1);var y=n();void 0!==y&&(t=y)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[o,n,i]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};r.O.j=function(t){return 0===e[t]};var t=function(t,o){var n,i,a=o[0],s=o[1],p=o[2],y=0;if(a.some((function(t){return 0!==e[t]}))){for(n in s)r.o(s,n)&&(r.m[n]=s[n]);if(p)var c=p(r)}for(t&&t(o);y<a.length;y++)i=a[y],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(c)},o=self["webpackChunkopenlayertest"]=self["webpackChunkopenlayertest"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=r.O(void 0,[504],(function(){return r(368)}));o=r.O(o)})();
//# sourceMappingURL=app.042efbd1.js.map